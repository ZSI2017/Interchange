"use strict";Zepto(function(e){function t(){showLoading();var t={},s=jUrl+"/ep/sender/list";e.axs(s,t,function(t){if(hideLoading(),t.meta.success&&(s&&ant.setSessionData({data:{senderCount:s.length}}),e(".manage-bottom").show(),"0000"==t.meta.code||t.meta.success)){var s=t.result;if(console.log("result "+s),s&&s.length>0){e(".manageInfo-select").show(),e(".emptyInfo").hide();var t={myResult:s},a=template("table-template",t);e(".manageInfo-select").html(a),s.map(function(t,d){"1"==t.defaultStatus&&(e(".setDefault").eq(d).addClass("defaultSender"),e(".setDefault").eq(d).find(".am-list-title").css("color","#108ee9"),e(".setDefault").eq(d).find(".am-list-title").html("默认地址"),e(".setDefault").eq(d).find("img").attr("src","https://expressprod.oss-cn-hangzhou.aliyuncs.com/mobile/img/selected.png"));var s=t.name;e(".myTempName").eq(d).html(s);var a=getAreaNameByCode(t.districtCode).replace(/\s/g,"")+t.address;e(".littleAddress").eq(d).html(a)}),d()}else e(".manageInfo-select").hide(),e(".emptyInfo").show()}})}function d(){e(".btn-check-send").click(function(){e(".btn-check-send").parent().find("input[name='sendRadio']").attr("checked",!1),e(this).parent().find("input[name='sendRadio']").attr("checked",!0)}),e(".setDefault").click(function(t){var d=e(this).attr("senderAddrID"),a=e(".setDefault").index(this)+1;"默认地址"==e(this).find(".am-list-title").text()?(e(this).find(".am-list-title").attr("data-spmv","a106.b2103.c4598_"+a+".d7339"),BizLog.call("info",{spmId:"a106.b2103.c4598_"+a+".d7339",actionId:"clicked",params:{AddrID:d}})):(e(this).find(".am-list-title").attr("data-spmv","a106.b2103.c4598_"+a+".d7115"),BizLog.call("info",{spmId:"a106.b2103.c4598_"+a+".d7115",actionId:"clicked",params:{AddrID:d}})),s(d,e(this).parents(".oneline").find(".editDefault"))}),e(".delSender").click(function(t){var d=e(this).attr("senderAddrID"),s=e(".delSender").index(this)+1;e(this).attr("data-spmv","a106.b2103.c4598_"+s+".d7117"),BizLog.call("info",{spmId:"a106.b2103.c4598_"+s+".d7117",actionId:"clicked",params:{AddrID:d}}),a(d,e(this))}),e(".editDefault").click(function(t){var d=e(this).attr("senderAddrID"),s=e(".editDefault").index(this)+1;e(this).attr("data-spmv","a106.b2103.c4598_"+s+".d7116"),BizLog.call("info",{spmId:"a106.b2103.c4598_"+s+".d7116",actionId:"clicked",params:{AddrID:d}});var d=(e(this).find("input").val(),e(this).attr("senderAddrID")),a=e(this).attr("real-sendnumber"),n=e(this).find(".realname").text().trim(),i=e(this).find(".detailAddress").text().trim(),r=e(this).attr("provinceNo"),o=e(this).attr("cityNo"),l=e(this).attr("areaNo"),c=getAreaNameByCode(l).replace(/\s/g,"");ant.setSessionData({data:{edit_senderAddrID:d,edit_sendName:n,edit_sendNumber:a,edit_sendAddress:i,edit_sendProvinceCode:r,edit_sendCityCode:o,edit_sendAreaCode:l,edit_street:c}}),pushWindow("send-address.html?edit=edit",!0)})}function s(t,d){console.log(d.html()),console.log("_this.attr(senderName)"+d.attr("senderName"));var s=e(".defaultSender");if(e("#sender_"+t).attr("senderAddrID")!=s.attr("senderAddrID")){var a={senderId:JSON.parse(t)},n=jUrl+"/ep/sender/set_default";e.axs(n,a,function(a){if(a.meta.success){ant.getSessionData({keys:["senderAddrID"]},function(e){if(e.data.senderAddrID);else{var t=d.find("input").val(),s=d.attr("senderAddrID"),a=t,n=d.attr("senderNumber"),i=d.attr("real-sendnumber");realSendName=d.find(".realname").text().trim(),sendProvinceCode=d.attr("provinceNo"),sendCityCode=d.attr("cityNo"),sendAreaCode=d.attr("areaNo"),street=getAreaNameByCode(sendAreaCode).replace(/\s/g,""),sendAddress=d.attr("detailAddress"),console.log("_this.attr(senderName)"+d.attr("senderName")),console.log('_this.attr("street")'+street),ant.setSessionData({data:{senderAddrID:s,sendName:a,real_sendName:realSendName,real_sendNumber:i,sendNumber:n,sendProvinceCode:sendProvinceCode,sendCityCode:sendCityCode,sendAreaCode:sendAreaCode,sendStreet:street,sendAddress:sendAddress}})}}),s.find(".am-list-title").css({color:"#999"}),s.find(".am-list-title").html("设为默认"),s.find("img").attr("src","https://expressprod.oss-cn-hangzhou.aliyuncs.com/mobile/img/unselected.png"),s.removeClass("defaultSender");var n=e("#sender_"+t);n.find(".am-list-title").css({color:"#108ee9"}),n.find(".am-list-title").html("默认地址"),n.find("img").attr("src","https://expressprod.oss-cn-hangzhou.aliyuncs.com/mobile/img/selected.png"),n.addClass("defaultSender")}})}}function a(d,s){if(confirm("确认删除?")){BizLog.call("info",{spmId:"a106.b2103.c4680.d7295",actionId:"clicked",params:{AddrID:d}});var a={senderId:JSON.parse(d)},n=jUrl+"/ep/sender/delete";e.axs(n,a,function(e){e.meta.success&&"0000"==e.meta.code&&(ant.getSessionData({keys:["senderAddrID"]},function(e){e.data.senderAddrID==d&&ant.setSessionData({data:{senderAddrID:"",sendName:"",sendNumber:"",real_sendNumber:"",real_sendName:"",sendProvinceCode:"",sendCityCode:"",sendAreaCode:"",sendStreet:"",sendAddress:""}})}),toast({text:"删除成功",type:"success"}),t())})}else BizLog.call("info",{spmId:"a106.b2103.c4680.d7294",actionId:"clicked",params:{AddrID:d}}),console.log("取消删除！")}FastClick.attach(document.body),ant.call("setTitle",{title:"管理寄件人地址"}),t(),ant.on("resume",function(e){ant.setSessionData({data:{edit_senderAddrID:"",edit_sendName:"",edit_sendNumber:"",edit_sendAddress:"",edit_sendProvinceCode:"",edit_sendCityCode:"",edit_sendAreaCode:"",edit_street:""}}),t()}),e(".btn-sender").click(function(){BizLog.call("info",{spmId:"a106.b2103.c4597.d7114",actionId:"clicked"}),pushWindow("send-address.html",!0)})});