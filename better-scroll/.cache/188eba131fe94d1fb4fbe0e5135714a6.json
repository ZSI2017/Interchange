{"dependencies":[{"name":"./libs\\bscroll.js","dynamic":true}],"generated":{"html":"<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"description\" content=\"\">\r\n    <meta name=\"keywords\" content=\"\">\r\n    <meta http-equiv=\"Cache-Control\" content=\"no-cache\">\r\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\r\n    <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\">\r\n    <meta name=\"format-detection\" content=\"telephone=no\">\r\n    <meta name=\"format-detection\" content=\"email=no\">\r\n    <meta name=\"data-bizType\" content=\"express\">\r\n    <meta name=\"data-aspm\" content=\"a106\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0\">\r\n    <title> better-scroll study</title>\r\n    <script type=\"text/javascript\" src=\"/dist/dc913bec84f59606be80721e883b447c.js\"> </script>\r\n    <link rel=\"stylesheet\" href=\"https://gw.alipayobjects.com/as/g/antui/antui/10.1.8/rem/antui.css\">\r\n    <link rel=\"stylesheet\" href=\"https://gw.alipayobjects.com/as/g/antui/antui/10.1.8/rem/widget/loading.css\">\r\n    <link rel=\"stylesheet\" href=\"https://gw.alipayobjects.com/as/g/antui/antui/10.1.8/rem/base/media.css\">\r\n    <script type=\"text/javascript\" src=\"https://a.alipayobjects.com/amui/zepto/1.1.3/zepto.js\"></script>\r\n    <style>\r\n    html,body,.wrapper{\r\n      height:100%;\r\n      width:100%;\r\n    }\r\n     .content li{\r\n        box-sizing: border-box;\r\n        width:100%;\r\n        height:200px;\r\n        border:1px solid black;\r\n        background-color:grey;\r\n     }\r\n\r\n     .list-wrapper {\r\n       position: absolute;\r\n       top:0;\r\n       left:0;\r\n       right:0;\r\n       bottom:0;\r\n       overflow: hidden\r\n     }\r\n\r\n    </style>\r\n  </head>\r\n  <body>\r\n<div class=\"list-wrapper\">\r\n    <div class=\"wrapper\">\r\n\r\n      <ul class=\"content\">\r\n        <li>1 - better-scroll</li>\r\n        <li>2 - better-scroll</li>\r\n        <li>3 - better-scroll</li>\r\n        <li>4 - better-scroll</li>\r\n        <li>5 - better-scroll</li>\r\n        <li>6 - better-scroll</li>\r\n        <li>7 - better-scroll</li>\r\n        <li>8 - better-scroll</li>\r\n      </ul>\r\n    </div>\r\n<div id=\"mesage1\" style=\"height:120px;font-size:16px;text-align:center;line-height:1;position:absolute;top:-80px;left:0;right:0;text-align:center\">\r\n  <canvas id=\"cvs\" width=\"50\" height=\"80\" style=\"width: 50px; height: 80px;\"></canvas>\r\n  <div class=\"am-loading\" aria-label=\"加载中\" style=\"padding-top:0.04rem;padding-bottom:0;display:none\">\r\n       <i class=\"am-icon loading\" aria-hidden=\"true\"></i>\r\n  </div>\r\n   <!-- <p style=\"color:#d2d2d2\">正在刷新...</p> -->\r\n</div>\r\n    <!-- <p class=\"pulldown-warp\" style=\"\">刷新中。。。</p> -->\r\n  </div>\r\n\r\n\r\n\r\n      <script>\r\n  var scroll = new BScroll('.wrapper',{\r\n    scrollY: true,\r\n    click: true,\r\n    tap:true,\r\n    bounce:true,\r\n    bounceTime:700,\r\n    isAnimating:true,\r\n    useTransition:true,\r\n    scrollbar:true,\r\n    pullDownRefresh:{\tthreshold:30,stop:50},\r\n    threshold:100\r\n  });\r\n  $('.content li').click(function(e){\r\n    console.log(e);\r\n  });\r\n  var toggle = true;\r\n  scroll.on(\"pullingDown\",function(e){\r\n    toggle = false;\r\n      $(\".pulldown-warp\").html(\"刷新中。。。。\")\r\n      $(\"#cvs\").hide();\r\n      $(\".am-loading\").show();\r\n\r\n    setTimeout(function(){\r\n      $(\"#cvs\").show();\r\n      $(\".am-loading\").hide();\r\n      // scroll.scrollTo(0,0)\r\n     toggle = true;\r\n      scroll.finishPullDown();\r\n    },1000)\r\n  })\r\n\r\n  scroll.on('scroll',function(pos){\r\n    if(toggle){\r\n      $(\".pulldown-warp\").html(\"下拉刷新！\")\r\n    }\r\n    var bubbleY = Math.max(0,pos.y-50);\r\n    bubbleVue(bubbleY,pos.y);\r\n    // if()\r\n\r\n    $(\".pulldown-warp\").css(\"top\",Math.min(pos.y-50,10));\r\n    $(\"#mesage1\").css(\"top\",Math.min(pos.y-50,10));\r\n  })\r\n\r\n  function bubbleVue(bubbleY,posY) {\r\n      var y = bubbleY;\r\n      var ratio = window.devicePixelRatio;\r\n\r\n      var width =  50 * ratio;\r\n      var height = 80 * ratio;\r\n      var initRadius = 18 * ratio;\r\n      var minHeadRadius = 12 * ratio;\r\n      var minTailRadius = 5 * ratio;\r\n      var initArrowRadius = 10 * ratio;\r\n      var minArrowRadius = 6 * ratio;\r\n      var arrowWidth = 3 * ratio;\r\n      var maxDistance = 30 * ratio;\r\n      var initCenterX = 25 * ratio;\r\n      var initCenterY = 25 * ratio;\r\n      var headCenter = {\r\n        x: initCenterX,\r\n        y: initCenterY\r\n      };\r\n      var distance = Math.max(0, Math.min(bubbleY * ratio, maxDistance))\r\n\r\n      _draw();\r\n\r\n      function _draw() {\r\n        var bubble = document.getElementById(\"cvs\");\r\n        bubble.width = width;\r\n        bubble.height = height;\r\n        var ctx = bubble.getContext('2d');\r\n        ctx.clearRect(0, 0, bubble.width, bubble.height)\r\n        ctx.lineWidth = 1;\r\n        _drawBubble(ctx);\r\n\r\n        _drawArrow(ctx)\r\n\r\n      }\r\n\r\n      function _drawBubble(ctx) {\r\n        ctx.save()\r\n        ctx.beginPath()\r\n\r\n        const rate = distance / maxDistance\r\n        console.log(distance +\"   \"+maxDistance);\r\n        const headRadius = initRadius - (initRadius - minHeadRadius) * rate\r\n        // const headRadius = 24;\r\n        headCenter.y = initCenterY - (initRadius - minHeadRadius) * rate\r\n        // console.log(initCenterY +\" \"+initRadius+\" \"+ \" \"+minHeadRadius+\" \"+rate);\r\n\r\n\r\n        // 画上半弧线\r\n        ctx.arc(headCenter.x, headCenter.y, headRadius, 0, Math.PI, true);\r\n\r\n        // console.log(headRadius);\r\n\r\n        // console.log(\"headCenter.x--\"+headCenter.x +\"  \"+\" headCenter.y: \"+ headCenter.y );\r\n\r\n        // 画左侧贝塞尔\r\n        const tailRadius = initRadius - (initRadius - minTailRadius) * rate\r\n        const tailCenter = {\r\n          x: headCenter.x,\r\n          y: headCenter.y + distance\r\n        }\r\n\r\n        const tailPointL = {\r\n          x: tailCenter.x - tailRadius,\r\n          y: tailCenter.y\r\n        }\r\n        const controlPointL = {\r\n          x: tailPointL.x,\r\n          y: tailPointL.y - distance / 2\r\n        }\r\n\r\n        ctx.quadraticCurveTo(controlPointL.x, controlPointL.y, tailPointL.x, tailPointL.y)\r\n\r\n        // 画下半弧线\r\n        ctx.arc(tailCenter.x, tailCenter.y, tailRadius, Math.PI, 0, true)\r\n\r\n        // 画右侧贝塞尔\r\n        const headPointR = {\r\n          x: headCenter.x + headRadius,\r\n          y: headCenter.y\r\n        }\r\n        const controlPointR = {\r\n          x: tailCenter.x + tailRadius,\r\n          y: headPointR.y + distance / 2\r\n        }\r\n        ctx.quadraticCurveTo(controlPointR.x, controlPointR.y, headPointR.x, headPointR.y)\r\n\r\n        ctx.fillStyle = 'rgb(170,170,170)'\r\n        ctx.fill()\r\n        ctx.strokeStyle = 'rgb(153,153,153)'\r\n        ctx.stroke()\r\n        ctx.restore()\r\n      }\r\n\r\n      function  _drawArrow(ctx) {\r\n        ctx.save()\r\n        ctx.beginPath()\r\n        const rate = distance / maxDistance\r\n        const arrowRadius = initArrowRadius - (initArrowRadius - minArrowRadius) * rate\r\n        // 画内圆\r\n        ctx.arc(headCenter.x, headCenter.y, arrowRadius - (arrowWidth - rate), -Math.PI / 2, 0, true)\r\n        // 画外圆\r\n        ctx.arc(headCenter.x, headCenter.y, arrowRadius, 0, Math.PI * 3 / 2, false)\r\n        ctx.lineTo(headCenter.x, headCenter.y - arrowRadius - arrowWidth / 2 + rate)\r\n        ctx.lineTo(headCenter.x + arrowWidth * 2 - rate * 2, headCenter.y - arrowRadius + arrowWidth / 2)\r\n\r\n        ctx.lineTo(headCenter.x, headCenter.y - arrowRadius + arrowWidth * 3 / 2 - rate)\r\n\r\n        ctx.fillStyle = 'rgb(255,255,255)'\r\n        ctx.fill()\r\n        ctx.strokeStyle = 'rgb(170,170,170)'\r\n        ctx.stroke()\r\n        ctx.restore()\r\n      }\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n  // console.log(scroll);\r\n  </script>\r\n  </body>\r\n</html>\r\n"},"hash":"1cec477082d802fcf70b9d6f9b0c406d"}